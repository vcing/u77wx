{"version":3,"sources":["webpack:///./src/share/share.entry.js","webpack:///./src/share/share.js"],"names":[],"mappings":"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","file":"share.js","sourcesContent":["import {Base} from '../base/base.js';\r\nimport {Share} from './share.js';\r\n\r\n$(async function(){\r\n\twindow.base.share = new Share();\r\n\tlet path = \"http://ldev.u77wx.leanapp.cn/server-weixin/lead/share/\"+$('#u77-unionid').val();\r\n\tawait window.base.weixin.init();\r\n\twx.onMenuShareTimeline({\r\n\t    title: '您的好友向您发起了一次爱抽抽,不抽随便的邀请.', // 分享标题\r\n\t    link: path, // 分享链接\r\n\t    imgUrl: 'http://file.u77.com/weixin/mslogo.png', // 分享图标\r\n\t    success: function () { \r\n\t        // 用户确认分享后执行的回调函数\r\n\t        window.base.share.shareSuccess('circle');\r\n\t    },\r\n\t    cancel: function () { \r\n\t        // 用户取消分享后执行的回调函数\r\n\t    }\r\n\t});\r\n\twx.onMenuShareAppMessage({\r\n\t    title: '您的好友向您发起了一次爱抽抽,不抽随便的邀请.', // 分享标题\r\n\t    desc: '萌神赵子龙,迎战大夏天.无脑策划又开始瞎TM送礼品了.', // 分享描述\r\n\t    link: path, // 分享链接\r\n\t    imgUrl: 'http://file.u77.com/weixin/mslogo.png', // 分享图标\r\n\t    type: 'link', // 分享类型,music、video或link，不填默认为link\r\n\t    dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空\r\n\t    success: function () { \r\n\t        // 用户确认分享后执行的回调函数\r\n\t        window.base.share.shareSuccess('friend');\r\n\t    },\r\n\t    cancel: function () { \r\n\t        // 用户取消分享后执行的回调函数\r\n\t    }\r\n\t});\r\n\r\n\t\r\n})\n\n\n/** WEBPACK FOOTER **\n ** ./src/share/share.entry.js\n **/","import {BaseClass} from '../base/baseClass.js';\r\nimport moment from 'moment';\r\n\r\nlet path = \"http://192.168.1.105:3000/\";\r\n\r\nexport class Share extends BaseClass {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.unionId = $('#u77-unionid').val();\r\n\t\tthis.state = $('#u77-state').val();\r\n\t\tthis.initState();\r\n\t\tthis.checkState();\r\n\t\tthis.paperOpen = false;\r\n\t}\r\n\r\n\tasync draw() {\r\n\t\tif(this.count <= 0){\r\n\t\t\talert('抽奖次数已经用完了,赶快分享获取更多抽奖机会吧.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this.paperOpen) {\r\n\t\t\tthis.machineReset();\r\n\t\t\tthis.paperOpen = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.count--;\r\n\t\t$('#u77-share .lottery .machine .times').text(this.count);\r\n\t\tthis.brokenAnimate();\r\n\t\tlet result = await $.get(path+'lottery',{unionId:this.unionId});\r\n\t\tlet award = \"\";\r\n\t\tresult.count = parseInt(result.count);\r\n\t\tswitch(result.count) {\r\n\t\t\tcase 1:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/lb.png\" width=\"50\">*1`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/ctm.png\" width=\"50\">*1`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/szbf.png\" width=\"50\">*1`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/gjzml.png\" width=\"50\">*2`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/jys.png\" width=\"50\">*2`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/zml.png\" width=\"50\">*2`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 7:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/sxf.png\" width=\"50\">*5`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 8:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/jh.png\" width=\"50\">*50`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 9:\r\n\t\t\t\taward=`<img src=\"http://file.u77.com/weixin/msicon/xll.png\" width=\"50\">*5`;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t$('#u77-share .lottery .machine .entry .paper .prize').html(award);\r\n\t\t$('#u77-share .lottery .machine .entry .paper .code').html(result.code);\r\n\t\tthis.paperOpen = true;\r\n\t\tthis.showPaper();\r\n\t}\r\n\r\n\tshowPaper() {\r\n\t\t$('#u77-share .lottery .machine .entry .paper').animate({\r\n\t\t\ttop:0\r\n\t\t},3000);\r\n\t}\r\n\r\n\tcheckState() {\r\n\t\tif(this.state != 'default') {\r\n\t\t\t$.get(path+'share/join',{\r\n\t\t\t\tshareUnionId:this.state,\r\n\t\t\t\tjoinUnionId:this.unionId,\r\n\t\t\t\ttime:moment().unix()\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tasync initState() {\r\n\t\tlet count = await $.get(path+'lottery/init',{unionId:this.unionId});\r\n\t\tthis.count = count;\r\n\t\t$('#u77-share .lottery .machine .times').text(count);\r\n\t}\r\n\r\n\tbrokenAnimate() {\r\n\t\tthis.ball  = $('#u77-share .lottery .rocker .ball');\r\n\t\tthis.hPole = $('#u77-share .lottery .rocker .h-pole');\r\n\t\tthis.vPole = $('#u77-share .lottery .rocker .v-pole');\r\n\r\n\t\tthis.ballBottom  = this.ball.css('bottom');\r\n\t\tthis.ballLeft    = this.ball.css('left');\r\n\t\tthis.hPoleBottom = this.hPole.css('bottom');\r\n\t\tthis.hPoleLeft   = this.hPole.css('left');\r\n\t\tthis.vPoleBottom = this.vPole.css('bottom');\r\n\t\tthis.vPoleLeft   = this.vPole.css('left');\r\n\r\n\t\tthis.fallAnimate(this.ball);\r\n\t\tthis.fallAnimate(this.hPole);\r\n\t\tthis.fallAnimate(this.vPole);\r\n\t}\r\n\r\n\tfallAnimate(dom,height = 0) {\r\n\t\t// dom.addClass('animate-rotate');\r\n\t\tthis._fall(dom,height)();\r\n\t}\r\n\r\n\t_fall(dom,height = 0) {\r\n\t\tlet ease = 'swing';\r\n\t\treturn () => {\r\n\t\t\tif(height == 0)height = dom.css('bottom');\r\n\t\t\theight = parseInt(height);\r\n\t\t\tif(height < 10)return;\r\n\t\t\theight /= 2;\r\n\t\t\tlet left = dom.css('left');\r\n\t\t\tleft = parseInt(left);\r\n\t\t\tconsole.log(left);\r\n\t\t\tlet angle = Math.random() * 50; \r\n\t\t\tlet leftOffset = (0.5-Math.random())*100\r\n\r\n\t\t\tdom.animate({bottom:0,left:(left - leftOffset/2)+'px','-webkit-transform':`rotate(${angle}deg)`},300,ease,() => {\r\n\t\t\t\tdom.animate({bottom:height+'px',left:(left - leftOffset/2)+'px','-webkit-transform':`rotate(${angle}deg)`},300,ease,this._fall(dom,height));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tmachineReset() {\r\n\t\tthis.ball.animate({left:this.ballLeft,bottom:this.ballBottom},300,'swing');\r\n\t\tthis.hPole.animate({left:this.hPoleLeft,bottom:this.hPoleBottom},300,'swing');\r\n\t\tthis.vPole.animate({left:this.vPoleLeft,bottom:this.vPoleBottom},300,'swing');\r\n\t\t$('#u77-share .lottery .machine .entry .paper').animate({\r\n\t\t\ttop:\"-100%\"\r\n\t\t},2000);\r\n\t}\r\n\r\n\tshareSuccess(type) {\r\n\t\t$.get(path+'share',{\r\n\t\t\tunionId:this.unionId,\r\n\t\t\tfrom:type,\r\n\t\t\ttime:moment().unix()\r\n\t\t},(result) => {\r\n\t\t\tif(result.status == 100){\r\n\t\t\t\tthis.count++;\r\n\t\t\t\t$('#u77-share .lottery .machine .times').text(this.count);\r\n\t\t\t\treturn;\r\n\t\t\t}else if(result.status == 110) {\r\n\r\n\t\t\t}else {\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/share/share.js\n **/"],"sourceRoot":""}